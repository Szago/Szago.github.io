<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LevelUp Cost Calculator</title>
</head>
<body>

  <div id="levelInputContainer">
    <label for="labelInput">Enter Level (1-170): </label>
    <input type="text" id="labelInput">
  </div>

  <div id="rangeInputContainer" style="display:none;">
    <label for="startLevelInput">Starting Level: </label>
    <input type="text" id="startLevelInput">
    <label for="endLevelInput">End Level: </label>
    <input type="text" id="endLevelInput">
  </div>

  <button onclick="toggleInputMode()">Choose Range</button>
  <button onclick="retrieveCost()">Calculate Cost</button>

  <p id="result"></p>

  <script>
    async function getLevelsFromJSON() {
      try {
        const response = await fetch('levels.json');
        const data = await response.json();
        return data.levels;
      } catch (error) {
        console.error('Error loading levels:', error);
        return null;
      }
    }

    let levels = null;
    let isRangeMode = false;

    async function initLevels() {
      levels = await getLevelsFromJSON();
      if (!levels) {
        alert('Failed to load levels. Check the console for details.');
      }
    }

    initLevels(); // Initialize levels on page load

    function getNumberFromLabel(label) {
      const index = parseInt(label) - 1;
      if (index >= 0 && index < levels.length) {
        return levels[index];
      } else {
        return null; // Invalid label
      }
    }

    function calculateTotalCost(startLevel, endLevel) {
      const startIdx = parseInt(startLevel) - 1;
      const endIdx = parseInt(endLevel) - 1;

      if (startIdx >= 0 && endIdx < levels.length && startIdx <= endIdx) {
        return levels.slice(startIdx, endIdx + 1).reduce((total, value) => total + value, 0);
      } else {
        return null; // Invalid levels
      }
    }

    function toggleInputMode() {
      isRangeMode = !isRangeMode;
      const levelInputContainer = document.getElementById('levelInputContainer');
      const rangeInputContainer = document.getElementById('rangeInputContainer');

      if (isRangeMode) {
        levelInputContainer.style.display = 'none';
        rangeInputContainer.style.display = 'block';
      } else {
        levelInputContainer.style.display = 'block';
        rangeInputContainer.style.display = 'none';
      }
    }

    function retrieveCost() {
      const resultElement = document.getElementById('result');

      if (isRangeMode) {
        const startLevel = document.getElementById('startLevelInput').value;
        const endLevel = document.getElementById('endLevelInput').value;
        const total = calculateTotalCost(startLevel, endLevel);

        if (total !== null) {
          resultElement.innerHTML = `Total cost from level ${startLevel} to ${endLevel}: ${total}`;
        } else {
          resultElement.textContent = 'Invalid levels. Please make sure the range is valid.';
        }
      } else {
        const levelInput = document.getElementById('labelInput').value;
        const number = getNumberFromLabel(levelInput);

        if (number !== null) {
          resultElement.innerHTML = `Number for level ${levelInput}: ${number}`;
        } else {
          resultElement.textContent = 'Invalid level. Please enter a number between 1 and 170.';
        }
      }
    }
  </script>

</body>
</html>
